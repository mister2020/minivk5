{"version":3,"sources":["../../../../src/components/DatePicker/DatePicker.tsx"],"names":["React","Input","withAdaptivity","leadingZero","CustomSelect","DefaultMonths","convertToInputFormat","day","month","year","parseInputDate","date","splited","split","Number","getMonthMaxDay","Date","getDate","range","start","end","swap","arr","i","Math","min","max","push","reverse","DatePickerCustom","name","dayPlaceholder","monthPlaceholder","yearPlaceholder","popupDirection","defaultValue","hasMouse","monthNames","onDateChange","disabled","restProps","onSelectChange","e","target","value","dayOptions","map","label","String","monthOptions","index","yearOptions","DatePickerNative","defProps","onStringChange","useCallback","currentTarget","DatePicker","props","useState","setValue","update","Cmp","defaultProps"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport Input from '../Input/Input';\nimport { withAdaptivity, AdaptivityProps } from '../../hoc/withAdaptivity';\nimport { HasPlatform } from '../../types';\nimport { leadingZero } from '../../lib/utils';\nimport CustomSelect from '../CustomSelect/CustomSelect';\nimport './DatePicker.css';\n\nconst DefaultMonths: string[] = [\n  'Января', 'Февраля', 'Марта', 'Апреля', 'Мая', 'Июня', 'Июля', 'Августа', 'Сентября', 'Октября', 'Ноября', 'Декабря',\n];\n\nexport type DatePickerDateFormat = {\n  day: number;\n  month: number;\n  year: number;\n};\n\nexport interface DatePickerProps extends Omit<React.HTMLAttributes<HTMLDivElement>, 'defaultValue' | 'min' | 'max'>, HasPlatform, AdaptivityProps {\n  min?: DatePickerDateFormat;\n  max?: DatePickerDateFormat;\n  name?: string;\n  defaultValue?: DatePickerDateFormat;\n  popupDirection?: 'top' | 'bottom';\n  monthNames?: string[];\n  dayPlaceholder?: string;\n  monthPlaceholder?: string;\n  yearPlaceholder?: string;\n  onDateChange?: (value: DatePickerDateFormat) => void;\n  disabled?: boolean;\n}\n\n// Переводим state к формату гг-мм-дд\nfunction convertToInputFormat({ day, month, year }: Partial<DatePickerDateFormat>) {\n  return `${year}-${leadingZero(month)}-${leadingZero(day)}`;\n}\n\n// Переводим дату формата гг-мм-дд к объекту\nfunction parseInputDate(date: string): DatePickerDateFormat {\n  const splited = date.split('-');\n\n  return {\n    day: Number(splited[2]),\n    month: Number(splited[1]),\n    year: Number(splited[0]),\n  };\n}\n\nfunction getMonthMaxDay(month?: number, year?: number) {\n  return month ? new Date(year || 2016, month, 0).getDate() : 31;\n}\n\nconst range = (start: number, end: number) => {\n  const swap = start > end;\n  const arr = [];\n  for (let i = Math.min(start, end); i <= Math.max(start, end); i++) {\n    arr.push(i);\n  }\n  return swap ? arr.reverse() : arr;\n};\n\nconst DatePickerCustom: React.FC<DatePickerProps & Partial<DatePickerDateFormat>> = ({\n  name, min, max,\n  dayPlaceholder, monthPlaceholder, yearPlaceholder,\n  popupDirection,\n  defaultValue,\n  hasMouse,\n  monthNames,\n  day, month, year,\n  onDateChange,\n  disabled,\n  ...restProps\n}) => {\n  const onSelectChange: React.ChangeEventHandler<HTMLSelectElement> = (e) => {\n    onDateChange({\n      day,\n      month,\n      year,\n      [e.target.name]: Number(e.target.value),\n    });\n  };\n  const dayOptions = range(1, getMonthMaxDay(month, year)).map((value) => ({\n    label: String(value),\n    value,\n  }));\n  const monthOptions = (monthNames || DefaultMonths).map((name, index) => ({\n    label: name,\n    value: index + 1,\n  }));\n  const yearOptions = range(max.year, min.year).map((value) => ({\n    label: String(value),\n    value: value,\n  }));\n  return (\n    <div vkuiClass=\"DatePicker\" {...restProps}>\n      <div vkuiClass=\"DatePicker__container\">\n        <div vkuiClass=\"DatePicker__day\">\n          <CustomSelect\n            name=\"day\"\n            value={day}\n            options={dayOptions}\n            placeholder={dayPlaceholder}\n            popupDirection={popupDirection}\n            onChange={onSelectChange}\n            disabled={disabled}\n          />\n        </div>\n        <div vkuiClass=\"DatePicker__month\">\n          <CustomSelect\n            vkuiClass=\"DatePicker__monthSelect\"\n            name=\"month\"\n            value={month}\n            options={monthOptions}\n            placeholder={monthPlaceholder}\n            popupDirection={popupDirection}\n            onChange={onSelectChange}\n            disabled={disabled}\n          />\n        </div>\n        <div vkuiClass=\"DatePicker__year\">\n          <CustomSelect\n            name=\"year\"\n            value={year}\n            options={yearOptions}\n            placeholder={yearPlaceholder}\n            popupDirection={popupDirection}\n            onChange={onSelectChange}\n            disabled={disabled}\n          />\n        </div>\n      </div>\n      <input type=\"hidden\" name={name} value={convertToInputFormat({ day, month, year })} />\n    </div>\n  );\n};\n\nconst DatePickerNative: React.FC<DatePickerProps & Partial<DatePickerDateFormat>> = ({\n  min, max,\n  dayPlaceholder, monthPlaceholder, yearPlaceholder,\n  popupDirection,\n  defaultValue,\n  hasMouse,\n  day, month, year,\n  onDateChange,\n  ...restProps\n}) => {\n  const defProps = day && month && year\n    ? { defaultValue: convertToInputFormat({ day, month, year }) }\n    : {};\n  const onStringChange: React.ChangeEventHandler<HTMLInputElement> = React.useCallback((e) => {\n    onDateChange(parseInputDate(e.currentTarget.value));\n  }, [onDateChange]);\n  return (\n    <Input\n      {...restProps}\n      type=\"date\"\n      onChange={onStringChange}\n      min={convertToInputFormat(min)}\n      max={convertToInputFormat(max)}\n      {...defProps}\n    />\n  );\n};\n\nconst DatePicker: React.FC<DatePickerProps> = ({ hasMouse, defaultValue, ...props }) => {\n  const [value, setValue] = React.useState<Partial<DatePickerDateFormat>>(defaultValue || {\n    day: 0,\n    month: 0,\n    year: 0,\n  });\n\n  const onDateChange = React.useCallback((update: DatePickerDateFormat) => {\n    setValue(update);\n    props.onDateChange && props.onDateChange({ ...update });\n  }, [props.onDateChange]);\n\n  const Cmp = hasMouse ? DatePickerCustom : DatePickerNative;\n  return <Cmp {...props} {...value} onDateChange={onDateChange} />;\n};\n\nDatePicker.defaultProps = {\n  min: { day: 0, month: 0, year: 0 },\n  max: { day: 31, month: 12, year: 2100 },\n};\n\nexport default withAdaptivity(DatePicker, {\n  hasMouse: true,\n});\n"],"file":"DatePicker.js"}