{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport * as React from 'react';\nimport { useIsomorphicLayoutEffect } from \"../../lib/useIsomorphicLayoutEffect\";\nexport var ModalRootContext = /*#__PURE__*/React.createContext({\n  updateModalHeight: function updateModalHeight() {\n    return undefined;\n  },\n  registerModal: function registerModal() {\n    return undefined;\n  },\n  isInsideModal: false\n});\n/**\n * All referenced elements must be static\n */\n\nexport function useModalRegistry(id, type) {\n  var modalContext = React.useContext(ModalRootContext);\n  var elements = React.useRef({}).current;\n  useIsomorphicLayoutEffect(function () {\n    modalContext.registerModal(_objectSpread(_objectSpread({}, elements), {}, {\n      type: type,\n      id: id\n    })); // unset refs on  unmount to prevent leak\n\n    var reset = Object.keys(elements).reduce(function (acc, k) {\n      return _objectSpread(_objectSpread({}, acc), {}, _defineProperty({}, k, null));\n    }, {\n      type: type,\n      id: id\n    });\n    return function () {\n      return modalContext.registerModal(reset);\n    };\n  }, []);\n  var refs = React.useRef({\n    modalElement: function modalElement(e) {\n      return elements.modalElement = e;\n    },\n    innerElement: function innerElement(e) {\n      return elements.innerElement = e;\n    },\n    headerElement: function headerElement(e) {\n      return elements.headerElement = e;\n    },\n    contentElement: function contentElement(e) {\n      return elements.contentElement = e;\n    },\n    footerElement: function footerElement(e) {\n      return elements.footerElement = e;\n    }\n  }).current;\n  return {\n    refs: refs\n  };\n}\nexport default ModalRootContext;","map":{"version":3,"sources":["../../../src/components/ModalRoot/ModalRootContext.tsx"],"names":["ModalRootContext","updateModalHeight","registerModal","isInsideModal","modalContext","React","elements","useIsomorphicLayoutEffect","type","id","reset","refs","modalElement","innerElement","headerElement","contentElement","footerElement"],"mappings":";;AAAA,OAAO,KAAP,KAAA,MAAA,OAAA;AACA,SAAA,yBAAA,QAAA,qCAAA;AAaA,OAAO,IAAMA,gBAAgB,GAAA,aAAG,KAAK,CAAL,aAAA,CAA+C;AAC7EC,EAAAA,iBAAiB,EAAE,SAAA,iBAAA,GAAA;AAAA,WAAA,SAAA;AAD0D,GAAA;AAE7EC,EAAAA,aAAa,EAAE,SAAA,aAAA,GAAA;AAAA,WAAA,SAAA;AAF8D,GAAA;AAG7EC,EAAAA,aAAa,EAAE;AAH8D,CAA/C,CAAzB;AAMP;AACA;AACA;;AACA,OAAO,SAAA,gBAAA,CAAA,EAAA,EAAA,IAAA,EAAuD;AAC5D,MAAMC,YAAY,GAAGC,KAAK,CAALA,UAAAA,CAArB,gBAAqBA,CAArB;AACA,MAAMC,QAAQ,GAAGD,KAAK,CAALA,MAAAA,CAAAA,EAAAA,EAAjB,OAAA;AACAE,EAAAA,yBAAyB,CAAC,YAAM;AAC9BH,IAAAA,YAAY,CAAZA,aAAAA,CAAAA,aAAAA,CAAAA,aAAAA,CAAAA,EAAAA,EAAAA,QAAAA,CAAAA,EAAAA,EAAAA,EAAAA;AAA0CI,MAAAA,IAAI,EAA9CJ,IAAAA;AAAgDK,MAAAA,EAAE,EAAFA;AAAhDL,KAAAA,CAAAA,EAD8B,CAE9B;;AACA,QAAMM,KAAK,GAAG,MAAM,CAAN,IAAA,CAAA,QAAA,EAAA,MAAA,CACZ,UAAA,GAAA,EAAA,CAAA,EAAA;AAAA,aAAA,aAAA,CAAA,aAAA,CAAA,EAAA,EAAA,GAAA,CAAA,EAAA,EAAA,EAAA,eAAA,CAAA,EAAA,EAAA,CAAA,EAAA,IAAA,CAAA,CAAA;AADY,KAAA,EAEZ;AAAEF,MAAAA,IAAI,EAAN,IAAA;AAAQC,MAAAA,EAAE,EAAFA;AAAR,KAFY,CAAd;AAGA,WAAO,YAAA;AAAA,aAAML,YAAY,CAAZA,aAAAA,CAAN,KAAMA,CAAN;AAAP,KAAA;AANuB,GAAA,EAAzBG,EAAyB,CAAzBA;AASA,MAAMI,IAAI,GAAG,KAAK,CAAL,MAAA,CAAkC;AAC7CC,IAAAA,YAAY,EAAE,SAAA,YAAA,CAAA,CAAA,EAAA;AAAA,aAAON,QAAQ,CAARA,YAAAA,GAAP,CAAA;AAD+B,KAAA;AAE7CO,IAAAA,YAAY,EAAE,SAAA,YAAA,CAAA,CAAA,EAAA;AAAA,aAAOP,QAAQ,CAARA,YAAAA,GAAP,CAAA;AAF+B,KAAA;AAG7CQ,IAAAA,aAAa,EAAE,SAAA,aAAA,CAAA,CAAA,EAAA;AAAA,aAAOR,QAAQ,CAARA,aAAAA,GAAP,CAAA;AAH8B,KAAA;AAI7CS,IAAAA,cAAc,EAAE,SAAA,cAAA,CAAA,CAAA,EAAA;AAAA,aAAOT,QAAQ,CAARA,cAAAA,GAAP,CAAA;AAJ6B,KAAA;AAK7CU,IAAAA,aAAa,EAAE,SAAA,aAAA,CAAA,CAAA,EAAA;AAAA,aAAOV,QAAQ,CAARA,aAAAA,GAAP,CAAA;AAAA;AAL8B,GAAlC,EAAb,OAAA;AAOA,SAAO;AAAEK,IAAAA,IAAI,EAAJA;AAAF,GAAP;AACD;AAED,eAAA,gBAAA","sourcesContent":["import * as React from 'react';\nimport { useIsomorphicLayoutEffect } from '../../lib/useIsomorphicLayoutEffect';\nimport { ModalElements, ModalsStateEntry, ModalType } from './types';\n\nexport type ModalRegistryEntry = ModalElements & Required<Pick<ModalsStateEntry, 'type' | 'id'>>;\ntype ModalRefs = { [k in keyof ModalElements]: (e: ModalElements[k]) => void };\n\nexport interface ModalRootContextInterface {\n  updateModalHeight: VoidFunction;\n  registerModal(data: ModalRegistryEntry): void;\n  onClose?: VoidFunction;\n  isInsideModal: boolean;\n}\n\nexport const ModalRootContext = React.createContext<ModalRootContextInterface>({\n  updateModalHeight: () => undefined,\n  registerModal: () => undefined,\n  isInsideModal: false,\n});\n\n/**\n * All referenced elements must be static\n */\nexport function useModalRegistry(id: string, type: ModalType) {\n  const modalContext = React.useContext(ModalRootContext);\n  const elements = React.useRef<ModalElements>({}).current;\n  useIsomorphicLayoutEffect(() => {\n    modalContext.registerModal({ ...elements, type, id });\n    // unset refs on  unmount to prevent leak\n    const reset = Object.keys(elements).reduce<ModalRegistryEntry>(\n      (acc, k: keyof ModalElements) => ({ ...acc, [k]: null }),\n      { type, id });\n    return () => modalContext.registerModal(reset);\n  }, []);\n\n  const refs = React.useRef<Required<ModalRefs>>({\n    modalElement: (e) => elements.modalElement = e,\n    innerElement: (e) => elements.innerElement = e,\n    headerElement: (e) => elements.headerElement = e,\n    contentElement: (e) => elements.contentElement = e,\n    footerElement: (e) => elements.footerElement = e,\n  }).current;\n  return { refs };\n}\n\nexport default ModalRootContext;\n"]},"metadata":{},"sourceType":"module"}