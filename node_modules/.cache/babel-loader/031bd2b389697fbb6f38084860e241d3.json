{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport { createScopedElement } from \"../../lib/jsxRuntime\";\nimport * as React from 'react';\nimport { hasMouse as _hasMouse } from '@vkontakte/vkjs';\nimport { AdaptivityContext, SizeType, ViewHeight, ViewWidth } from \"./AdaptivityContext\";\nimport { useDOM } from \"../../lib/dom\";\nexport var DESKTOP_SIZE = 1280;\nexport var TABLET_SIZE = 1024;\nexport var SMALL_TABLET_SIZE = 768;\nexport var MOBILE_SIZE = 320;\nexport var MOBILE_LANDSCAPE_HEIGHT = 414;\nexport var MEDIUM_HEIGHT = 720;\nexport default function AdaptivityProvider(props) {\n  var adaptivityRef = React.useRef(null);\n\n  var _React$useState = React.useState({}),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      updateAdaptivity = _React$useState2[1];\n\n  var _useDOM = useDOM(),\n      window = _useDOM.window;\n\n  if (!adaptivityRef.current) {\n    adaptivityRef.current = calculateAdaptivity(window ? window.innerWidth : 0, window ? window.innerHeight : 0, props);\n  }\n\n  React.useEffect(function () {\n    function onResize() {\n      var calculated = calculateAdaptivity(window.innerWidth, window.innerHeight, props);\n      var _adaptivityRef$curren = adaptivityRef.current,\n          viewWidth = _adaptivityRef$curren.viewWidth,\n          viewHeight = _adaptivityRef$curren.viewHeight,\n          sizeX = _adaptivityRef$curren.sizeX,\n          sizeY = _adaptivityRef$curren.sizeY,\n          hasMouse = _adaptivityRef$curren.hasMouse;\n\n      if (viewWidth !== calculated.viewWidth || viewHeight !== calculated.viewHeight || sizeX !== calculated.sizeX || sizeY !== calculated.sizeY || hasMouse !== calculated.hasMouse) {\n        adaptivityRef.current = calculated;\n        updateAdaptivity({});\n      }\n    }\n\n    onResize();\n    window.addEventListener('resize', onResize, false);\n    return function () {\n      window.removeEventListener('resize', onResize, false);\n    };\n  }, [props.viewWidth, props.viewHeight, props.sizeX, props.sizeY, props.hasMouse]);\n  return createScopedElement(AdaptivityContext.Provider, {\n    value: adaptivityRef.current\n  }, props.children);\n}\n\nfunction calculateAdaptivity(windowWidth, windowHeight, props) {\n  var viewWidth = ViewWidth.SMALL_MOBILE;\n  var viewHeight = ViewHeight.SMALL;\n  var sizeY = SizeType.REGULAR;\n  var sizeX = SizeType.REGULAR;\n  var hasMouse = typeof props.hasMouse === 'boolean' ? props.hasMouse : _hasMouse;\n\n  if (windowWidth >= DESKTOP_SIZE) {\n    viewWidth = ViewWidth.DESKTOP;\n  } else if (windowWidth >= TABLET_SIZE) {\n    viewWidth = ViewWidth.TABLET;\n  } else if (windowWidth >= SMALL_TABLET_SIZE) {\n    viewWidth = ViewWidth.SMALL_TABLET;\n  } else if (windowWidth >= MOBILE_SIZE) {\n    viewWidth = ViewWidth.MOBILE;\n  } else {\n    viewWidth = ViewWidth.SMALL_MOBILE;\n  }\n\n  if (windowHeight >= MEDIUM_HEIGHT) {\n    viewHeight = ViewHeight.MEDIUM;\n  } else if (windowHeight > MOBILE_LANDSCAPE_HEIGHT) {\n    viewHeight = ViewHeight.SMALL;\n  } else {\n    viewHeight = ViewHeight.EXTRA_SMALL;\n  }\n\n  props.viewWidth && (viewWidth = props.viewWidth);\n  props.viewHeight && (viewHeight = props.viewHeight);\n\n  if (viewWidth <= ViewWidth.MOBILE) {\n    sizeX = SizeType.COMPACT;\n  }\n\n  if (viewWidth >= ViewWidth.SMALL_TABLET && hasMouse || viewHeight <= ViewHeight.EXTRA_SMALL) {\n    sizeY = SizeType.COMPACT;\n  }\n\n  props.sizeX && (sizeX = props.sizeX);\n  props.sizeY && (sizeY = props.sizeY);\n  return {\n    viewWidth: viewWidth,\n    viewHeight: viewHeight,\n    sizeX: sizeX,\n    sizeY: sizeY,\n    hasMouse: hasMouse\n  };\n}","map":{"version":3,"sources":["../../../src/components/AdaptivityProvider/AdaptivityProvider.tsx"],"names":["hasMouse","DESKTOP_SIZE","TABLET_SIZE","SMALL_TABLET_SIZE","MOBILE_SIZE","MOBILE_LANDSCAPE_HEIGHT","MEDIUM_HEIGHT","adaptivityRef","React","updateAdaptivity","window","useDOM","calculateAdaptivity","calculated","viewWidth","viewHeight","sizeX","sizeY","onResize","props","current","ViewWidth","ViewHeight","SizeType","windowWidth","windowHeight"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { hasMouse as _hasMouse } from '@vkontakte/vkjs';\nimport { AdaptivityContext, AdaptivityContextInterface, SizeType, ViewHeight, ViewWidth } from './AdaptivityContext';\nimport { useDOM } from '../../lib/dom';\n\nexport interface AdaptivityProviderProps extends AdaptivityContextInterface {\n  children?: React.ReactNode;\n}\n\nexport const DESKTOP_SIZE = 1280;\nexport const TABLET_SIZE = 1024;\nexport const SMALL_TABLET_SIZE = 768;\nexport const MOBILE_SIZE = 320;\n\nexport const MOBILE_LANDSCAPE_HEIGHT = 414;\nexport const MEDIUM_HEIGHT = 720;\n\nexport default function AdaptivityProvider(props: AdaptivityProviderProps) {\n  const adaptivityRef = React.useRef<AdaptivityContextInterface>(null);\n  const [, updateAdaptivity] = React.useState({});\n\n  const { window } = useDOM();\n\n  if (!adaptivityRef.current) {\n    adaptivityRef.current = calculateAdaptivity(\n      window ? window.innerWidth : 0,\n      window ? window.innerHeight : 0,\n      props,\n    );\n  }\n\n  React.useEffect(() => {\n    function onResize() {\n      const calculated = calculateAdaptivity(window.innerWidth, window.innerHeight, props);\n      const { viewWidth, viewHeight, sizeX, sizeY, hasMouse } = adaptivityRef.current;\n\n      if (\n        viewWidth !== calculated.viewWidth ||\n        viewHeight !== calculated.viewHeight ||\n        sizeX !== calculated.sizeX ||\n        sizeY !== calculated.sizeY ||\n        hasMouse !== calculated.hasMouse\n      ) {\n        adaptivityRef.current = calculated;\n        updateAdaptivity({});\n      }\n    }\n\n    onResize();\n    window.addEventListener('resize', onResize, false);\n\n    return () => {\n      window.removeEventListener('resize', onResize, false);\n    };\n  }, [props.viewWidth, props.viewHeight, props.sizeX, props.sizeY, props.hasMouse]);\n\n  return (\n    <AdaptivityContext.Provider value={adaptivityRef.current}>\n      {props.children}\n    </AdaptivityContext.Provider>\n  );\n}\n\nfunction calculateAdaptivity(windowWidth: number, windowHeight: number, props: AdaptivityProviderProps) {\n  let viewWidth = ViewWidth.SMALL_MOBILE;\n  let viewHeight = ViewHeight.SMALL;\n  let sizeY = SizeType.REGULAR;\n  let sizeX = SizeType.REGULAR;\n  let hasMouse = typeof props.hasMouse === 'boolean' ? props.hasMouse : _hasMouse;\n\n  if (windowWidth >= DESKTOP_SIZE) {\n    viewWidth = ViewWidth.DESKTOP;\n  } else if (windowWidth >= TABLET_SIZE) {\n    viewWidth = ViewWidth.TABLET;\n  } else if (windowWidth >= SMALL_TABLET_SIZE) {\n    viewWidth = ViewWidth.SMALL_TABLET;\n  } else if (windowWidth >= MOBILE_SIZE) {\n    viewWidth = ViewWidth.MOBILE;\n  } else {\n    viewWidth = ViewWidth.SMALL_MOBILE;\n  }\n\n  if (windowHeight >= MEDIUM_HEIGHT) {\n    viewHeight = ViewHeight.MEDIUM;\n  } else if (windowHeight > MOBILE_LANDSCAPE_HEIGHT) {\n    viewHeight = ViewHeight.SMALL;\n  } else {\n    viewHeight = ViewHeight.EXTRA_SMALL;\n  }\n\n  props.viewWidth && (viewWidth = props.viewWidth);\n  props.viewHeight && (viewHeight = props.viewHeight);\n\n  if (viewWidth <= ViewWidth.MOBILE) {\n    sizeX = SizeType.COMPACT;\n  }\n\n  if (viewWidth >= ViewWidth.SMALL_TABLET && hasMouse || viewHeight <= ViewHeight.EXTRA_SMALL) {\n    sizeY = SizeType.COMPACT;\n  }\n\n  props.sizeX && (sizeX = props.sizeX);\n  props.sizeY && (sizeY = props.sizeY);\n\n  return { viewWidth, viewHeight, sizeX, sizeY, hasMouse };\n}\n"]},"metadata":{},"sourceType":"module"}