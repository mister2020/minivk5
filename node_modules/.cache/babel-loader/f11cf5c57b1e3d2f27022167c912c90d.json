{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _typeof from \"@babel/runtime/helpers/typeof\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _extends from \"@babel/runtime/helpers/extends\";\nvar _excluded = [\"children\", \"isShown\", \"offsetX\", \"offsetY\", \"alignX\", \"alignY\", \"onClose\", \"cornerOffset\", \"cornerAbsoluteOffset\"];\nimport { createScopedElement } from \"../../lib/jsxRuntime\";\nimport * as React from 'react';\nimport ReactDOM from 'react-dom';\nimport { classNames } from \"../../lib/classNames\";\nimport { getClassName } from \"../../helpers/getClassName\";\nimport Subhead from \"../Typography/Subhead/Subhead\";\nimport { usePopper } from 'react-popper';\nimport { tooltipContainerAttr } from \"./TooltipContainer\";\nimport { useExternRef } from \"../../hooks/useExternRef\";\nimport { useDOM } from \"../../lib/dom\";\nimport { warnOnce } from \"../../lib/warnOnce\";\nimport { hasReactNode } from \"../../lib/utils\";\nimport { useGlobalEventListener } from \"../../hooks/useGlobalEventListener\";\n\nvar isDOMTypeElement = function isDOMTypeElement(element) {\n  return /*#__PURE__*/React.isValidElement(element) && typeof element.type === 'string';\n};\n\nvar baseClassName = getClassName('Tooltip');\nvar warn = warnOnce('Tooltip');\nvar IS_DEV = process.env.NODE_ENV === 'development';\nvar SimpleTooltip = /*#__PURE__*/React.forwardRef(function SimpleTooltip(_ref, ref) {\n  var _ref$mode = _ref.mode,\n      mode = _ref$mode === void 0 ? 'accent' : _ref$mode,\n      header = _ref.header,\n      text = _ref.text,\n      arrowRef = _ref.arrowRef,\n      _ref$style = _ref.style,\n      style = _ref$style === void 0 ? {} : _ref$style,\n      attributes = _ref.attributes;\n  return createScopedElement(\"div\", {\n    vkuiClass: classNames(baseClassName, \"Tooltip--\".concat(mode))\n  }, createScopedElement(\"div\", _extends({\n    vkuiClass: \"Tooltip__container\",\n    ref: ref,\n    style: style.container\n  }, attributes.container), createScopedElement(\"div\", _extends({\n    vkuiClass: \"Tooltip__corner\",\n    style: style.arrow\n  }, attributes.arrow, {\n    ref: arrowRef\n  })), createScopedElement(\"div\", {\n    vkuiClass: \"Tooltip__content\"\n  }, header && createScopedElement(Subhead, {\n    weight: \"semibold\",\n    vkuiClass: \"Tooltip__title\"\n  }, header), text && createScopedElement(Subhead, {\n    weight: \"regular\",\n    vkuiClass: \"Tooltip__text\"\n  }, text))));\n});\n\nfunction mapAlignX(x) {\n  switch (x) {\n    case 'left':\n      return 'start';\n\n    case 'right':\n      return 'end';\n\n    default:\n      return '';\n  }\n}\n\nfunction getPlacement(alignX, alignY) {\n  return [alignY || 'bottom', mapAlignX(alignX || 'left')].filter(function (p) {\n    return !!p;\n  }).join('-');\n}\n\nfunction isVerticalPlacement(placement) {\n  return placement.startsWith('top') || placement.startsWith('bottom');\n}\n\nvar Tooltip = function Tooltip(_ref2) {\n  var children = _ref2.children,\n      isShown = _ref2.isShown,\n      _ref2$offsetX = _ref2.offsetX,\n      offsetX = _ref2$offsetX === void 0 ? 0 : _ref2$offsetX,\n      _ref2$offsetY = _ref2.offsetY,\n      offsetY = _ref2$offsetY === void 0 ? 15 : _ref2$offsetY,\n      alignX = _ref2.alignX,\n      alignY = _ref2.alignY,\n      onClose = _ref2.onClose,\n      cornerOffset = _ref2.cornerOffset,\n      cornerAbsoluteOffset = _ref2.cornerAbsoluteOffset,\n      restProps = _objectWithoutProperties(_ref2, _excluded);\n\n  var _React$useState = React.useState(),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      tooltipRef = _React$useState2[0],\n      setTooltipRef = _React$useState2[1];\n\n  var _React$useState3 = React.useState(),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      tooltipArrowRef = _React$useState4[0],\n      setTooltipArrowRef = _React$useState4[1];\n\n  var _React$useState5 = React.useState(),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      target = _React$useState6[0],\n      setTarget = _React$useState6[1];\n\n  if (IS_DEV) {\n    var multiChildren = React.Children.count(children) > 1; // Empty children is a noop\n\n    var primitiveChild = hasReactNode(children) && _typeof(children) !== 'object';\n    (multiChildren || primitiveChild) && warn(['children must be a single React element, got', multiChildren && 'multiple', primitiveChild && JSON.stringify(children)].filter(Boolean).join(' '));\n  }\n  /* eslint-disable no-restricted-properties */\n\n  /* eslint-disable @typescript-eslint/no-unnecessary-type-assertion*/\n\n\n  var tooltipContainer = React.useMemo(function () {\n    return target === null || target === void 0 ? void 0 : target.closest(\"[\".concat(tooltipContainerAttr, \"]\"));\n  }, [target]);\n  var strategy = React.useMemo(function () {\n    return (target === null || target === void 0 ? void 0 : target.style.position) === 'fixed' ? 'fixed' : 'absolute';\n  }, [target]);\n  /* eslint-enable @typescript-eslint/no-unnecessary-type-assertion*/\n\n  /* eslint-enable no-restricted-properties */\n\n  if (IS_DEV && target && !tooltipContainer) {\n    throw new Error('Use TooltipContainer for Tooltip outside Panel (see docs)');\n  }\n\n  var arrowOffsetModiifer = React.useMemo(function () {\n    return {\n      name: 'arrowOffset',\n      enabled: true,\n      phase: 'main',\n      fn: function fn(_ref3) {\n        var state = _ref3.state;\n\n        if (isVerticalPlacement(state.placement)) {\n          if (cornerAbsoluteOffset !== undefined) {\n            state.modifiersData.arrow.x = cornerAbsoluteOffset;\n          } else {\n            state.modifiersData.arrow.x += cornerOffset;\n          }\n        } else {\n          if (cornerAbsoluteOffset !== undefined) {\n            state.modifiersData.arrow.y = cornerAbsoluteOffset;\n          } else {\n            state.modifiersData.arrow.y += cornerOffset;\n          }\n        }\n      }\n    };\n  }, [cornerOffset, cornerAbsoluteOffset]);\n  var placement = getPlacement(alignX, alignY);\n\n  var _usePopper = usePopper(target, tooltipRef, {\n    strategy: strategy,\n    placement: placement,\n    modifiers: [{\n      name: 'offset',\n      options: {\n        offset: [offsetX, offsetY]\n      }\n    }, {\n      name: 'arrow',\n      options: {\n        element: tooltipArrowRef,\n        padding: 14\n      }\n    }, {\n      name: 'preventOverflow'\n    }, {\n      name: 'flip'\n    }, arrowOffsetModiifer]\n  }),\n      styles = _usePopper.styles,\n      attributes = _usePopper.attributes;\n\n  var _useDOM = useDOM(),\n      document = _useDOM.document;\n\n  useGlobalEventListener(document, 'click', isShown && onClose, {\n    passive: true\n  }); // NOTE: setting isShown to true used to trigger usePopper().forceUpdate()\n\n  var childRef = /*#__PURE__*/React.isValidElement(children) && (isDOMTypeElement(children) ? children.ref : children.props.getRootRef);\n  var patchedRef = useExternRef(setTarget, childRef);\n  var child = /*#__PURE__*/React.isValidElement(children) ? /*#__PURE__*/React.cloneElement(children, _defineProperty({}, isDOMTypeElement(children) ? 'ref' : 'getRootRef', patchedRef)) : children;\n  return createScopedElement(React.Fragment, null, child, isShown && target != null && /*#__PURE__*/ReactDOM.createPortal(createScopedElement(SimpleTooltip, _extends({}, restProps, {\n    ref: function ref(el) {\n      return setTooltipRef(el);\n    },\n    arrowRef: function arrowRef(el) {\n      return setTooltipArrowRef(el);\n    },\n    style: {\n      arrow: styles.arrow,\n      container: styles.popper\n    },\n    attributes: {\n      arrow: attributes.arrow,\n      container: attributes.popper\n    }\n  })), tooltipContainer));\n};\n\nTooltip.defaultProps = {\n  offsetX: 0,\n  offsetY: 15,\n  cornerOffset: 0,\n  isShown: true,\n  mode: 'accent'\n};\nexport default Tooltip;","map":{"version":3,"sources":["../../../src/components/Tooltip/Tooltip.tsx"],"names":["isDOMTypeElement","element","baseClassName","getClassName","warn","warnOnce","IS_DEV","process","SimpleTooltip","mode","header","text","arrowRef","style","attributes","classNames","container","arrow","alignY","mapAlignX","alignX","placement","Tooltip","children","isShown","offsetX","offsetY","onClose","cornerOffset","cornerAbsoluteOffset","restProps","tooltipRef","setTooltipRef","React","tooltipArrowRef","setTooltipArrowRef","target","setTarget","multiChildren","primitiveChild","hasReactNode","JSON","tooltipContainer","strategy","arrowOffsetModiifer","name","enabled","phase","fn","state","isVerticalPlacement","getPlacement","styles","usePopper","modifiers","options","offset","padding","document","useDOM","useGlobalEventListener","passive","childRef","patchedRef","useExternRef","child","popper"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport ReactDOM from 'react-dom';\nimport { classNames } from '../../lib/classNames';\nimport { getClassName } from '../../helpers/getClassName';\nimport Subhead from '../Typography/Subhead/Subhead';\nimport { Modifier, usePopper } from 'react-popper';\nimport { Placement } from '@popperjs/core';\nimport { tooltipContainerAttr } from './TooltipContainer';\nimport { useExternRef } from '../../hooks/useExternRef';\nimport { useDOM } from '../../lib/dom';\nimport { warnOnce } from '../../lib/warnOnce';\nimport { hasReactNode } from '../../lib/utils';\nimport { useGlobalEventListener } from '../../hooks/useGlobalEventListener';\nimport './Tooltip.css';\n\ninterface SimpleTooltipProps extends Partial<TooltipProps> {\n  target?: HTMLDivElement;\n  arrowRef?: React.Ref<HTMLDivElement>;\n  style?: {\n    arrow: React.CSSProperties;\n    container: React.CSSProperties;\n  };\n  attributes?: {\n    arrow: React.HTMLAttributes<HTMLDivElement>;\n    container: React.HTMLAttributes<HTMLDivElement>;\n  };\n}\n\nconst isDOMTypeElement = (element: React.ReactElement): element is React.DOMElement<any, any> => {\n  return React.isValidElement(element) && typeof element.type === 'string';\n};\n\nconst baseClassName = getClassName('Tooltip');\nconst warn = warnOnce('Tooltip');\nconst IS_DEV = process.env.NODE_ENV === 'development';\n\nconst SimpleTooltip = React.forwardRef<HTMLDivElement, SimpleTooltipProps>(\n  function SimpleTooltip(\n    { mode = 'accent', header, text, arrowRef, style = {}, attributes },\n    ref,\n  ) {\n    return (\n      <div vkuiClass={\n        classNames(\n          baseClassName,\n          `Tooltip--${mode}`,\n        )}>\n        <div vkuiClass=\"Tooltip__container\" ref={ref} style={style.container} {...attributes.container}>\n          <div vkuiClass=\"Tooltip__corner\" style={style.arrow} {...attributes.arrow} ref={arrowRef} />\n          <div vkuiClass=\"Tooltip__content\">\n            {header && <Subhead weight=\"semibold\" vkuiClass=\"Tooltip__title\">{header}</Subhead>}\n            {text && <Subhead weight=\"regular\" vkuiClass=\"Tooltip__text\">{text}</Subhead>}\n          </div>\n        </div>\n      </div>\n    );\n  });\n\nexport interface TooltipProps {\n  /**\n   * **Важно**: если в `children` передан React-компонент, то необходимо убедиться в том, что он поддерживает\n   * свойство `getRootRef`, которое должно возвращаться ссылку на корневой DOM-элемент компонента,\n   * иначе тултип показан не будет. Если передан React-element, то такой проблемы нет.\n   */\n  children: React.ReactElement;\n  mode?: 'accent' | 'light';\n  /**\n   * Если передан `false`, то рисуется просто `children`.\n   */\n  isShown?: boolean;\n  /**\n   * Текст тултипа.\n   */\n  text?: React.ReactNode;\n  /**\n   * Заголовок тултипа.\n   */\n  header?: React.ReactNode;\n  /**\n   * Положение по горизонтали (прижатие к левому или правому краю `children`).\n   * Если не задано, позиция по горизонтали определятся автоматически\n   */\n  alignX?: 'center' | 'left' | 'right';\n  /**\n   * Положение по вертикали (расположение над или под `children`).\n   * Если не задано, позиция по вертикали определятся автоматически\n   */\n  alignY?: 'top' | 'bottom';\n  /**\n   * Сдвиг по горизонтали (относительно портала, в котором рисуется тултип).\n   */\n  offsetX?: number;\n  /**\n   * Сдвиг по вертикали (относительно портала, в котором рисуется тултип).\n   */\n  offsetY?: number;\n  /**\n   * Сдвиг стрелочки относительно центра дочернего элемента.\n   */\n  cornerOffset?: number;\n  /**\n   * Сдвиг стрелочки относительно ширины тултипа\n   */\n  cornerAbsoluteOffset?: number;\n  /**\n   * Callback, который вызывается при клике по любому месту в пределах экрана.\n   */\n  onClose?: () => void;\n}\n\ndeclare type ArrowOffsetModifierOptions = {\n  offset: number;\n};\ndeclare type ArrowOffsetModifier = Modifier<'arrowOffset', ArrowOffsetModifierOptions>;\n\nfunction mapAlignX(x: TooltipProps['alignX']) {\n  switch (x) {\n    case 'left': return 'start';\n    case 'right': return 'end';\n    default: return '';\n  }\n}\nfunction getPlacement(alignX: TooltipProps['alignX'], alignY: TooltipProps['alignY']): Placement {\n  return [alignY || 'bottom', mapAlignX(alignX || 'left')].filter((p) => !!p).join('-') as Placement;\n}\nfunction isVerticalPlacement(placement: Placement) {\n  return placement.startsWith('top') || placement.startsWith('bottom');\n}\n\nconst Tooltip: React.FC<TooltipProps> = ({\n  children, isShown, offsetX = 0, offsetY = 15,\n  alignX, alignY, onClose, cornerOffset, cornerAbsoluteOffset,\n  ...restProps\n}) => {\n  const [tooltipRef, setTooltipRef] = React.useState<HTMLElement>();\n  const [tooltipArrowRef, setTooltipArrowRef] = React.useState<HTMLElement>();\n  const [target, setTarget] = React.useState<HTMLElement>();\n\n  if (IS_DEV) {\n    const multiChildren = React.Children.count(children) > 1;\n    // Empty children is a noop\n    const primitiveChild = hasReactNode(children) && typeof children !== 'object';\n    (multiChildren || primitiveChild) && warn([\n      'children must be a single React element, got',\n      multiChildren && 'multiple',\n      primitiveChild && JSON.stringify(children),\n    ].filter(Boolean).join(' '));\n  }\n\n  /* eslint-disable no-restricted-properties */\n  /* eslint-disable @typescript-eslint/no-unnecessary-type-assertion*/\n  const tooltipContainer = React.useMemo(() => target?.closest(`[${tooltipContainerAttr}]`) as HTMLDivElement, [target]);\n  const strategy = React.useMemo(() => target?.style.position === 'fixed' ? 'fixed' : 'absolute', [target]);\n  /* eslint-enable @typescript-eslint/no-unnecessary-type-assertion*/\n  /* eslint-enable no-restricted-properties */\n\n  if (IS_DEV && target && !tooltipContainer) {\n    throw new Error('Use TooltipContainer for Tooltip outside Panel (see docs)');\n  }\n\n  const arrowOffsetModiifer = React.useMemo<ArrowOffsetModifier>(() => {\n    return {\n      name: 'arrowOffset',\n      enabled: true,\n      phase: 'main',\n      fn({ state }) {\n        if (isVerticalPlacement(state.placement)) {\n          if (cornerAbsoluteOffset !== undefined) {\n            state.modifiersData.arrow.x = cornerAbsoluteOffset;\n          } else {\n            state.modifiersData.arrow.x += cornerOffset;\n          }\n        } else {\n          if (cornerAbsoluteOffset !== undefined) {\n            state.modifiersData.arrow.y = cornerAbsoluteOffset;\n          } else {\n            state.modifiersData.arrow.y += cornerOffset;\n          }\n        }\n      },\n    };\n  }, [cornerOffset, cornerAbsoluteOffset]);\n\n  const placement = getPlacement(alignX, alignY);\n  const { styles, attributes } = usePopper(target, tooltipRef, {\n    strategy,\n    placement,\n    modifiers: [\n      {\n        name: 'offset', options: {\n          offset: [\n            offsetX,\n            offsetY,\n          ],\n        },\n      },\n      {\n        name: 'arrow', options: {\n          element: tooltipArrowRef,\n          padding: 14,\n        },\n      },\n      {\n        name: 'preventOverflow',\n      },\n      {\n        name: 'flip',\n      },\n      arrowOffsetModiifer,\n    ],\n  });\n\n  const { document } = useDOM();\n  useGlobalEventListener(document, 'click', isShown && onClose, { passive: true });\n  // NOTE: setting isShown to true used to trigger usePopper().forceUpdate()\n\n  const childRef = React.isValidElement(children) &&\n    (isDOMTypeElement(children) ? children.ref : children.props.getRootRef);\n  const patchedRef = useExternRef(setTarget, childRef);\n  const child = React.isValidElement(children) ? React.cloneElement(children, {\n    [isDOMTypeElement(children) ? 'ref' : 'getRootRef']: patchedRef,\n  }) : children;\n\n  return (\n    <React.Fragment>\n      {child}\n      {isShown && target != null && ReactDOM.createPortal(\n        <SimpleTooltip\n          {...restProps}\n          ref={(el) => setTooltipRef(el)}\n          arrowRef={(el) => setTooltipArrowRef(el)}\n          style={{ arrow: styles.arrow, container: styles.popper }}\n          attributes={{ arrow: attributes.arrow, container: attributes.popper }}\n        />,\n        tooltipContainer,\n      )}\n    </React.Fragment>\n  );\n};\n\nTooltip.defaultProps = {\n  offsetX: 0,\n  offsetY: 15,\n  cornerOffset: 0,\n  isShown: true,\n  mode: 'accent',\n};\nexport default Tooltip;\n"]},"metadata":{},"sourceType":"module"}