{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nvar _excluded = [\"children\", \"layout\", \"action\", \"before\", \"after\", \"viewWidth\", \"duration\", \"onActionClick\", \"onClose\"];\nimport { createScopedElement } from \"../../lib/jsxRuntime\";\nimport * as React from 'react';\nimport Touch from \"../Touch/Touch\";\nimport { classNames } from \"../../lib/classNames\";\nimport { getClassName } from \"../../helpers/getClassName\";\nimport { ANDROID, VKCOM } from \"../../lib/platform\";\nimport { rubber } from \"../../lib/touch\";\nimport { withAdaptivity, ViewWidth } from \"../../hoc/withAdaptivity\";\nimport Text from \"../Typography/Text/Text\";\nimport Button from \"../Button/Button\";\nimport { AppRootPortal } from \"../AppRoot/AppRootPortal\";\nimport { useWaitTransitionFinish } from \"../../hooks/useWaitTransitionFinish\";\nimport { usePlatform } from \"../../hooks/usePlatform\";\nimport { useTimeout } from \"../../hooks/useTimeout\";\n\nvar SnackbarComponent = function SnackbarComponent(props) {\n  var children = props.children,\n      layout = props.layout,\n      action = props.action,\n      before = props.before,\n      after = props.after,\n      viewWidth = props.viewWidth,\n      duration = props.duration,\n      onActionClick = props.onActionClick,\n      onClose = props.onClose,\n      restProps = _objectWithoutProperties(props, _excluded);\n\n  var platform = usePlatform();\n\n  var _useWaitTransitionFin = useWaitTransitionFinish(),\n      waitTransitionFinish = _useWaitTransitionFin.waitTransitionFinish;\n\n  var _React$useState = React.useState(false),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      closing = _React$useState2[0],\n      setClosing = _React$useState2[1];\n\n  var _React$useState3 = React.useState(false),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      touched = _React$useState4[0],\n      setTouched = _React$useState4[1];\n\n  var shiftXPercentRef = React.useRef(0);\n  var shiftXCurrentRef = React.useRef(0);\n  var touchStartTimeRef = React.useRef(null);\n  var bodyElRef = React.useRef(null);\n  var innerElRef = React.useRef(null);\n  var animationFrameRef = React.useRef(null);\n  var isDesktop = viewWidth >= ViewWidth.SMALL_TABLET;\n  var transitionFinishDurationFallback = platform === ANDROID || platform === VKCOM ? 400 : 320;\n\n  var close = function close() {\n    setClosing(true);\n    waitTransitionFinish(innerElRef.current, function () {\n      onClose();\n    }, transitionFinishDurationFallback);\n  };\n\n  var handleActionClick = function handleActionClick(e) {\n    close();\n\n    if (action && typeof onActionClick === 'function') {\n      onActionClick(e);\n    }\n  };\n\n  var closeTimeout = useTimeout(close, duration);\n\n  var setBodyTransform = function setBodyTransform(percent) {\n    cancelAnimationFrame(animationFrameRef.current);\n    animationFrameRef.current = requestAnimationFrame(function () {\n      if (bodyElRef.current) {\n        bodyElRef.current.style.transform = \"translate3d(\".concat(percent, \"%, 0, 0)\");\n      }\n    });\n  };\n\n  var onTouchStart = closeTimeout.clear;\n\n  var onTouchMoveX = function onTouchMoveX(event) {\n    var shiftX = event.shiftX,\n        startT = event.startT,\n        originalEvent = event.originalEvent;\n    originalEvent.preventDefault();\n\n    if (!touched) {\n      setTouched(true);\n    }\n\n    shiftXPercentRef.current = shiftX / bodyElRef.current.offsetWidth * 100;\n    shiftXCurrentRef.current = rubber(shiftXPercentRef.current, 72, 1.2, platform === ANDROID || platform === VKCOM);\n    touchStartTimeRef.current = startT;\n    setBodyTransform(shiftXCurrentRef.current);\n  };\n\n  var onTouchEnd = function onTouchEnd() {\n    var callback;\n\n    if (touched) {\n      var shiftXCurrent = shiftXCurrentRef.current;\n      var expectTranslateY = shiftXCurrent / (Date.now() - touchStartTimeRef.current.getTime()) * 240 * 0.6;\n      shiftXCurrent = shiftXCurrent + expectTranslateY;\n\n      if (isDesktop && shiftXCurrent <= -50) {\n        closeTimeout.clear();\n        waitTransitionFinish(bodyElRef.current, function () {\n          onClose();\n        }, transitionFinishDurationFallback);\n        setBodyTransform(-120);\n      } else if (!isDesktop && shiftXCurrent >= 50) {\n        closeTimeout.clear();\n        waitTransitionFinish(bodyElRef.current, function () {\n          onClose();\n        }, transitionFinishDurationFallback);\n        setBodyTransform(120);\n      } else {\n        callback = function callback() {\n          closeTimeout.set();\n          setBodyTransform(0);\n        };\n      }\n    } else {\n      closeTimeout.set();\n    }\n\n    setTouched(false);\n    callback && requestAnimationFrame(callback);\n  };\n\n  React.useEffect(closeTimeout.set, []);\n  var resolvedLayout = after || isDesktop ? 'vertical' : layout;\n  return createScopedElement(AppRootPortal, null, createScopedElement(\"div\", _extends({}, restProps, {\n    vkuiClass: classNames(getClassName('Snackbar', platform), \"Snackbar--l-\".concat(resolvedLayout), {\n      'Snackbar--closing': closing,\n      'Snackbar--touched': touched,\n      'Snackbar--desktop': isDesktop\n    })\n  }), createScopedElement(Touch, {\n    vkuiClass: \"Snackbar__in\",\n    getRootRef: innerElRef,\n    onStart: onTouchStart,\n    onMoveX: onTouchMoveX,\n    onEnd: onTouchEnd\n  }, createScopedElement(\"div\", {\n    vkuiClass: \"Snackbar__body\",\n    ref: bodyElRef\n  }, before && createScopedElement(\"div\", {\n    vkuiClass: \"Snackbar__before\"\n  }, before), createScopedElement(\"div\", {\n    vkuiClass: \"Snackbar__content\"\n  }, createScopedElement(Text, {\n    weight: \"regular\",\n    vkuiClass: \"Snackbar__content-text\"\n  }, children), action && createScopedElement(Button, {\n    align: \"left\",\n    hasHover: false,\n    mode: \"tertiary\",\n    size: \"s\",\n    vkuiClass: \"Snackbar__action\",\n    onClick: handleActionClick\n  }, action)), after && createScopedElement(\"div\", {\n    vkuiClass: \"Snackbar__after\"\n  }, after)))));\n};\n\nSnackbarComponent.displayName = 'Snackbar';\nSnackbarComponent.defaultProps = {\n  duration: 4000,\n  layout: 'horizontal'\n};\nexport var Snackbar = withAdaptivity(SnackbarComponent, {\n  viewWidth: true\n});","map":{"version":3,"sources":["../../../src/components/Snackbar/Snackbar.tsx"],"names":["SnackbarComponent","children","layout","action","before","after","viewWidth","duration","onActionClick","onClose","restProps","props","platform","usePlatform","waitTransitionFinish","useWaitTransitionFinish","closing","setClosing","React","touched","setTouched","shiftXPercentRef","shiftXCurrentRef","touchStartTimeRef","bodyElRef","innerElRef","animationFrameRef","isDesktop","ViewWidth","transitionFinishDurationFallback","close","handleActionClick","closeTimeout","useTimeout","setBodyTransform","cancelAnimationFrame","requestAnimationFrame","onTouchStart","onTouchMoveX","shiftX","startT","originalEvent","event","rubber","onTouchEnd","shiftXCurrent","expectTranslateY","Date","callback","resolvedLayout","classNames","getClassName","Snackbar","withAdaptivity"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport Touch, { TouchEvent } from '../Touch/Touch';\nimport { classNames } from '../../lib/classNames';\nimport { HasPlatform } from '../../types';\nimport { getClassName } from '../../helpers/getClassName';\nimport { ANDROID, VKCOM } from '../../lib/platform';\nimport { rubber } from '../../lib/touch';\nimport { withAdaptivity, AdaptivityProps, ViewWidth } from '../../hoc/withAdaptivity';\nimport Text from '../Typography/Text/Text';\nimport Button from '../Button/Button';\nimport { AppRootPortal } from '../AppRoot/AppRootPortal';\nimport { useWaitTransitionFinish } from '../../hooks/useWaitTransitionFinish';\nimport { usePlatform } from '../../hooks/usePlatform';\nimport { useTimeout } from '../../hooks/useTimeout';\nimport './Snackbar.css';\n\nexport interface SnackbarProps extends React.HTMLAttributes<HTMLElement>, HasPlatform, AdaptivityProps {\n  /**\n   * Название кнопки действия в уведомлении\n   */\n  action?: string | React.ComponentType;\n\n  /**\n   * Будет вызвано при клике на кнопку действия\n   */\n  onActionClick?: (e: React.MouseEvent) => void;\n\n  /**\n   * Цветная иконка 24x24 пикселя\n   */\n  before?: React.ReactNode;\n  /**\n   * Контент в правой части, может быть `<Avatar size={32} />`\n   */\n  after?: React.ReactNode;\n  /**\n   * Варианты расположения кнопки\n   */\n  layout?: 'vertical' | 'horizontal';\n  /**\n   * Время в миллисекундах, через которое плашка скроется\n   */\n  duration?: number;\n  /**\n   * Обработчик закрытия уведомления\n   */\n  onClose: () => void;\n}\n\nconst SnackbarComponent: React.FC<SnackbarProps> = (props: SnackbarProps) => {\n  const {\n    children,\n    layout,\n    action,\n    before,\n    after,\n    viewWidth,\n    duration,\n    onActionClick,\n    onClose,\n    ...restProps\n  } = props;\n\n  const platform = usePlatform();\n\n  const { waitTransitionFinish } = useWaitTransitionFinish();\n\n  const [closing, setClosing] = React.useState(false);\n  const [touched, setTouched] = React.useState(false);\n\n  const shiftXPercentRef = React.useRef<number>(0);\n  const shiftXCurrentRef = React.useRef<number>(0);\n  const touchStartTimeRef = React.useRef<Date | null>(null);\n\n  const bodyElRef = React.useRef<HTMLDivElement | null>(null);\n  const innerElRef = React.useRef<HTMLDivElement | null>(null);\n\n  const animationFrameRef = React.useRef<ReturnType<typeof requestAnimationFrame> | null>(null);\n\n  const isDesktop = viewWidth >= ViewWidth.SMALL_TABLET;\n  const transitionFinishDurationFallback = platform === ANDROID || platform === VKCOM ? 400 : 320;\n\n  const close = () => {\n    setClosing(true);\n    waitTransitionFinish(innerElRef.current, () => {\n      onClose();\n    }, transitionFinishDurationFallback);\n  };\n\n  const handleActionClick: React.MouseEventHandler<HTMLElement> = (e) => {\n    close();\n\n    if (action && typeof onActionClick === 'function') {\n      onActionClick(e);\n    }\n  };\n\n  const closeTimeout = useTimeout(close, duration);\n\n  const setBodyTransform = (percent: number) => {\n    cancelAnimationFrame(animationFrameRef.current);\n    animationFrameRef.current = requestAnimationFrame(() => {\n      if (bodyElRef.current) {\n        bodyElRef.current.style.transform = `translate3d(${percent}%, 0, 0)`;\n      }\n    });\n  };\n\n  const onTouchStart = closeTimeout.clear;\n\n  const onTouchMoveX = (event: TouchEvent) => {\n    const { shiftX, startT, originalEvent } = event;\n    originalEvent.preventDefault();\n\n    if (!touched) {\n      setTouched(true);\n    }\n\n    shiftXPercentRef.current = shiftX / bodyElRef.current.offsetWidth * 100;\n    shiftXCurrentRef.current = rubber(shiftXPercentRef.current, 72, 1.2, platform === ANDROID || platform === VKCOM);\n    touchStartTimeRef.current = startT;\n\n    setBodyTransform(shiftXCurrentRef.current);\n  };\n\n  const onTouchEnd = () => {\n    let callback: VoidFunction | undefined;\n\n    if (touched) {\n      let shiftXCurrent = shiftXCurrentRef.current;\n      const expectTranslateY = shiftXCurrent / (Date.now() - touchStartTimeRef.current.getTime()) * 240 * 0.6;\n      shiftXCurrent = shiftXCurrent + expectTranslateY;\n\n      if (isDesktop && shiftXCurrent <= -50) {\n        closeTimeout.clear();\n        waitTransitionFinish(bodyElRef.current, () => {\n          onClose();\n        }, transitionFinishDurationFallback);\n        setBodyTransform(-120);\n      } else if (!isDesktop && shiftXCurrent >= 50) {\n        closeTimeout.clear();\n        waitTransitionFinish(bodyElRef.current, () => {\n          onClose();\n        }, transitionFinishDurationFallback);\n        setBodyTransform(120);\n      } else {\n        callback = () => {\n          closeTimeout.set();\n          setBodyTransform(0);\n        };\n      }\n    } else {\n      closeTimeout.set();\n    }\n\n    setTouched(false);\n    callback && requestAnimationFrame(callback);\n  };\n\n  React.useEffect(closeTimeout.set, []);\n\n  const resolvedLayout = after || isDesktop ? 'vertical' : layout;\n\n  return (\n    <AppRootPortal>\n      <div\n        {...restProps}\n        vkuiClass={classNames(getClassName('Snackbar', platform), `Snackbar--l-${resolvedLayout}`, {\n          'Snackbar--closing': closing,\n          'Snackbar--touched': touched,\n          'Snackbar--desktop': isDesktop,\n        })}\n      >\n        <Touch\n          vkuiClass=\"Snackbar__in\"\n          getRootRef={innerElRef}\n          onStart={onTouchStart}\n          onMoveX={onTouchMoveX}\n          onEnd={onTouchEnd}\n        >\n          <div vkuiClass=\"Snackbar__body\" ref={bodyElRef}>\n            {before &&\n            <div vkuiClass=\"Snackbar__before\">\n              {before}\n            </div>}\n\n            <div vkuiClass=\"Snackbar__content\">\n              <Text weight=\"regular\" vkuiClass=\"Snackbar__content-text\">{children}</Text>\n\n              {action &&\n              <Button align=\"left\" hasHover={false} mode=\"tertiary\" size=\"s\" vkuiClass=\"Snackbar__action\" onClick={handleActionClick}>\n                {action}\n              </Button>}\n            </div>\n\n            {after &&\n            <div vkuiClass=\"Snackbar__after\">\n              {after}\n            </div>}\n          </div>\n        </Touch>\n      </div>\n    </AppRootPortal>\n  );\n};\n\nSnackbarComponent.displayName = 'Snackbar';\n\nSnackbarComponent.defaultProps = {\n  duration: 4000,\n  layout: 'horizontal',\n};\n\nexport const Snackbar = withAdaptivity(SnackbarComponent, {\n  viewWidth: true,\n});\n"]},"metadata":{},"sourceType":"module"}