{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nvar _excluded = [\"children\", \"onRemove\", \"removePlaceholder\", \"align\"];\nimport { createScopedElement } from \"../../lib/jsxRuntime\";\nimport * as React from 'react';\nimport { classNames } from \"../../lib/classNames\";\nimport { getTitleFromChildren } from \"../../lib/utils\";\nimport { usePlatform } from \"../../hooks/usePlatform\";\nimport { getClassName } from \"../../helpers/getClassName\";\nimport { useAdaptivity } from \"../../hooks/useAdaptivity\";\nimport { useDOM } from \"../../lib/dom\";\nimport { ANDROID, IOS, VKCOM } from \"../../lib/platform\";\nimport { Icon24Cancel } from '@vkontakte/icons';\nimport IconButton from \"../IconButton/IconButton\";\nimport { useGlobalEventListener } from \"../../hooks/useGlobalEventListener\";\nimport Tappable from \"../Tappable/Tappable\";\nexport var Removable = function Removable(_ref) {\n  var children = _ref.children,\n      onRemove = _ref.onRemove,\n      _ref$removePlaceholde = _ref.removePlaceholder,\n      removePlaceholder = _ref$removePlaceholde === void 0 ? 'Удалить' : _ref$removePlaceholde,\n      _ref$align = _ref.align,\n      align = _ref$align === void 0 ? 'center' : _ref$align,\n      restProps = _objectWithoutProperties(_ref, _excluded);\n\n  var platform = usePlatform();\n\n  var _useAdaptivity = useAdaptivity(),\n      sizeY = _useAdaptivity.sizeY;\n\n  var _useDOM = useDOM(),\n      document = _useDOM.document;\n\n  var removeButtonRef = React.useRef(null);\n\n  var _React$useState = React.useState(false),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      isRemoveActivated = _React$useState2[0],\n      setRemoveActivated = _React$useState2[1];\n\n  var _React$useState3 = React.useState(0),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      removeOffset = _React$useState4[0],\n      updateRemoveOffset = _React$useState4[1];\n\n  useGlobalEventListener(document, 'click', isRemoveActivated && function () {\n    setRemoveActivated(false);\n    updateRemoveOffset(0);\n  });\n\n  var onRemoveTransitionEnd = function onRemoveTransitionEnd() {\n    if (isRemoveActivated) {\n      var _removeButtonRef$curr;\n\n      removeButtonRef === null || removeButtonRef === void 0 ? void 0 : (_removeButtonRef$curr = removeButtonRef.current) === null || _removeButtonRef$curr === void 0 ? void 0 : _removeButtonRef$curr.focus();\n    }\n  };\n\n  var onRemoveActivateClick = function onRemoveActivateClick(e) {\n    e.nativeEvent.stopPropagation();\n    e.preventDefault();\n    setRemoveActivated(true);\n  };\n\n  var onRemoveClick = function onRemoveClick(e) {\n    e.nativeEvent.stopImmediatePropagation();\n    e.preventDefault();\n    onRemove && onRemove(e);\n  };\n\n  React.useEffect(function () {\n    var removeButton = removeButtonRef === null || removeButtonRef === void 0 ? void 0 : removeButtonRef.current;\n\n    if (isRemoveActivated && removeButton) {\n      updateRemoveOffset(removeButton.offsetWidth);\n    }\n  }, [isRemoveActivated]);\n  var removePlaceholderString = getTitleFromChildren(removePlaceholder);\n  return createScopedElement(\"div\", _extends({}, restProps, {\n    vkuiClass: classNames(getClassName('Removable', platform), \"Removable--\".concat(align), \"Removable--sizeY-\".concat(sizeY))\n  }), (platform === ANDROID || platform === VKCOM) && createScopedElement(\"div\", {\n    vkuiClass: \"Removable__content\"\n  }, children, createScopedElement(IconButton, {\n    \"aria-label\": removePlaceholderString,\n    vkuiClass: \"Removable__action\",\n    onClick: onRemoveClick\n  }, createScopedElement(Icon24Cancel, {\n    role: \"presentation\"\n  }))), platform === IOS && createScopedElement(React.Fragment, null, createScopedElement(\"div\", {\n    vkuiClass: \"Removable__content\",\n    style: {\n      transform: \"translateX(-\".concat(removeOffset, \"px)\")\n    }\n  }, createScopedElement(IconButton, {\n    hasActive: false,\n    hasHover: false,\n    \"aria-label\": removePlaceholderString,\n    vkuiClass: \"Removable__action Removable__toggle\",\n    onClick: onRemoveActivateClick\n  }, createScopedElement(\"i\", {\n    vkuiClass: \"Removable__toggle-in\",\n    role: \"presentation\"\n  })), children, createScopedElement(\"span\", {\n    vkuiClass: \"Removable__offset\",\n    \"aria-hidden\": \"true\"\n  })), createScopedElement(Tappable, {\n    Component: \"button\",\n    hasActive: false,\n    hasHover: false,\n    disabled: !isRemoveActivated,\n    getRootRef: removeButtonRef,\n    vkuiClass: \"Removable__remove\",\n    onClick: onRemoveClick,\n    onTransitionEnd: onRemoveTransitionEnd,\n    style: {\n      transform: \"translateX(-\".concat(removeOffset, \"px)\")\n    }\n  }, createScopedElement(\"span\", {\n    vkuiClass: \"Removable__remove-in\"\n  }, removePlaceholder))));\n};","map":{"version":3,"sources":["../../../src/components/Removable/Removable.tsx"],"names":["Removable","children","onRemove","removePlaceholder","align","restProps","platform","usePlatform","sizeY","useAdaptivity","document","useDOM","removeButtonRef","React","isRemoveActivated","setRemoveActivated","removeOffset","updateRemoveOffset","useGlobalEventListener","onRemoveTransitionEnd","onRemoveActivateClick","e","onRemoveClick","removeButton","removePlaceholderString","getTitleFromChildren","classNames","getClassName","transform"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { classNames } from '../../lib/classNames';\nimport { getTitleFromChildren } from '../../lib/utils';\nimport { usePlatform } from '../../hooks/usePlatform';\nimport { getClassName } from '../../helpers/getClassName';\nimport { useAdaptivity } from '../../hooks/useAdaptivity';\nimport { useDOM } from '../../lib/dom';\nimport { ANDROID, IOS, VKCOM } from '../../lib/platform';\nimport { Icon24Cancel } from '@vkontakte/icons';\nimport IconButton from '../IconButton/IconButton';\nimport { useGlobalEventListener } from '../../hooks/useGlobalEventListener';\nimport Tappable from '../Tappable/Tappable';\nimport './Removable.css';\n\nexport interface RemovableProps {\n  /**\n   * iOS only. Текст в выезжающей кнопке для удаления ячейки.\n   */\n  removePlaceholder?: React.ReactNode;\n  /**\n   * Коллбэк срабатывает при клике на контрол удаления.\n   */\n  onRemove?: (e: React.MouseEvent, rootEl?: HTMLElement) => void;\n}\n\ninterface RemovableOwnProps extends React.AllHTMLAttributes<HTMLElement>, RemovableProps {\n  /**\n   * Расположение кнопки удаления.\n   */\n  align?: 'start' | 'center';\n}\n\nexport const Removable: React.FC<RemovableOwnProps> = ({\n  children,\n  onRemove,\n  removePlaceholder = 'Удалить',\n  align = 'center',\n  ...restProps\n}: RemovableOwnProps) => {\n  const platform = usePlatform();\n  const { sizeY } = useAdaptivity();\n  const { document } = useDOM();\n\n  const removeButtonRef = React.useRef(null);\n\n  const [isRemoveActivated, setRemoveActivated] = React.useState(false);\n  const [removeOffset, updateRemoveOffset] = React.useState(0);\n\n  useGlobalEventListener(document, 'click', isRemoveActivated && (() => {\n    setRemoveActivated(false);\n    updateRemoveOffset(0);\n  }));\n\n  const onRemoveTransitionEnd = () => {\n    if (isRemoveActivated) {\n      removeButtonRef?.current?.focus();\n    }\n  };\n\n  const onRemoveActivateClick = (e: React.MouseEvent) => {\n    e.nativeEvent.stopPropagation();\n    e.preventDefault();\n    setRemoveActivated(true);\n  };\n\n  const onRemoveClick = (e: React.MouseEvent) => {\n    e.nativeEvent.stopImmediatePropagation();\n    e.preventDefault();\n    onRemove && onRemove(e);\n  };\n\n  React.useEffect(() => {\n    const removeButton = removeButtonRef?.current;\n\n    if (isRemoveActivated && removeButton) {\n      updateRemoveOffset(removeButton.offsetWidth);\n    }\n  }, [isRemoveActivated]);\n\n  const removePlaceholderString: string = getTitleFromChildren(removePlaceholder);\n\n  return (\n    <div\n      {...restProps}\n      vkuiClass={classNames(\n        getClassName('Removable', platform),\n        `Removable--${align}`,\n        `Removable--sizeY-${sizeY}`,\n      )}\n    >\n      {(platform === ANDROID || platform === VKCOM) && (\n        <div vkuiClass=\"Removable__content\">\n          {children}\n\n          <IconButton\n            aria-label={removePlaceholderString}\n            vkuiClass=\"Removable__action\"\n            onClick={onRemoveClick}\n          >\n            <Icon24Cancel role=\"presentation\" />\n          </IconButton>\n        </div>\n      )}\n\n      {platform === IOS && (\n        <React.Fragment>\n          <div vkuiClass=\"Removable__content\" style={{ transform: `translateX(-${removeOffset}px)` }}>\n            <IconButton\n              hasActive={false}\n              hasHover={false}\n              aria-label={removePlaceholderString}\n              vkuiClass=\"Removable__action Removable__toggle\"\n              onClick={onRemoveActivateClick}\n            >\n              <i vkuiClass=\"Removable__toggle-in\" role=\"presentation\" />\n            </IconButton>\n            {children}\n\n            <span vkuiClass=\"Removable__offset\" aria-hidden=\"true\"></span>\n          </div>\n\n          <Tappable\n            Component=\"button\"\n            hasActive={false}\n            hasHover={false}\n            disabled={!isRemoveActivated}\n            getRootRef={removeButtonRef}\n            vkuiClass=\"Removable__remove\"\n            onClick={onRemoveClick}\n            onTransitionEnd={onRemoveTransitionEnd}\n            style={{ transform: `translateX(-${removeOffset}px)` }}\n          >\n            <span vkuiClass=\"Removable__remove-in\">{removePlaceholder}</span>\n          </Tappable>\n        </React.Fragment>\n      )}\n    </div>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}